<html>
	<head>
	<h1 style="text-align:center"> Astrological Meanings of the Planets</h1>
	</head>
	<style> 
	body {
  	background-image: url('images/planets.jpg');
	background-repeat: no-repeat;
  	background-attachment: fixed;
  	background-position: center;
	}

	/* Popup container - can be anything you want */
.popup {
  position: relative;
  display: inline-block;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup2 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup3 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup4 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup5 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup6 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup7 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup8 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup9 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.popup10 {
  position: relative;
  cursor: pointer;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

/* The actual popup */
.popup .popuptext {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 1;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup2 .popuptext2 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup3 .popuptext3 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup4 .popuptext4 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup5 .popuptext5 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup6 .popuptext6 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup7 .popuptext7 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup8 .popuptext8 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup9 .popuptext9 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* The actual popup */
.popup10 .popuptext10 {
  visibility: hidden;
  width: 160px;
  background-color: #555;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 8px 0;
  position: absolute;
  z-index: 4;
  bottom: 125%;
  left: 50%;
  margin-left: -80px;
}

/* Popup arrow */
.popup .popuptext::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup2 .popuptext2::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup3 .popuptext3::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup4 .popuptext4::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup5 .popuptext5::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup6 .popuptext6::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup7 .popuptext7::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup8 .popuptext8::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup9 .popuptext9::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Popup arrow */
.popup10 .popuptext10::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #555 transparent transparent transparent;
}

/* Toggle this class - hide and show the popup */
.popup .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup2 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup3 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup4 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup5 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup6 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup7 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup8 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup9 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Toggle this class - hide and show the popup */
.popup10 .show {
  visibility: visible;
  -webkit-animation: fadeIn 1s;
  animation: fadeIn 1s;
}

/* Add animation (fade in the popup) */
@-webkit-keyframes fadeIn {
  from {opacity: 0;} 
  to {opacity: 1;}
}

@keyframes fadeIn {
  from {opacity: 0;}
  to {opacity:1 ;}
}

</style>
	 	<script src="simplepeer.min.js"></script>
		<script type="text/javascript" src="/socket.io/socket.io.js"></script>
	
		<script type="text/javascript">
				
			let simplepeers = [];
			var socket;
			var mystream;
			let video;
			var canvas;// = document.getElementById('mycanvas');
			var context;// = canvas.getContext('2d');
			
			window.addEventListener('load', function() {
				
				// This kicks it off
				initCapture();

				canvas = document.getElementById('mycanvas');
				context = canvas.getContext('2d');
				console.log(context);
				mystream = canvas.captureStream(15);

			});

			function initCapture() {
				console.log("initCapture");
				
				// The video element on the page to display the webcam
				video = document.getElementById('myvideo');

				// Constraints - what do we want?
				let constraints = { audio: true, video: true }

				// Prompt the user for permission, get the stream
				navigator.mediaDevices.getUserMedia(constraints).then(function(stream) {
					/* Use the stream */

					// Global object
					//mystream = stream;

					// Attach to our video object
					video.srcObject = stream;
					
					// Wait for the stream to load enough to play
					video.onloadedmetadata = function(e) {
						video.play();

						//context.fillStyle="#00FF00";
						//context.fillRect(0,0,canvas.width,canvas.height);

						function draw() {
							context.drawImage(video,0,0,canvas.width,canvas.height);

							// Manipulate Video
							// Get at pixel data			
							var imageData = context.getImageData(0, 0, 640, 480);

							// iterate over all pixels
							for(var i = 0, n = imageData.data.length; i < n; i += 4) {
								
								// Get existing pixel data
								var red = imageData.data[i];
								var green = imageData.data[i + 1];
								var blue = imageData.data[i + 2];
								//var alpha = imageData.data[i + 3];

								// Set new pixel data
								imageData.data[i + 1] = red;
								imageData.data[i + 2] = red;
								//imageData.data[i + 3] = red;
							}
							context.putImageData(imageData, 0, 0);

							window.requestAnimationFrame(draw);
						}
						window.requestAnimationFrame(draw);

					};

					// Now setup socket
					setupSocket();
				})
				.catch(function(err) {
					/* Handle the error */
					alert(err);  
				});	
			}

			function setupSocket() {
				socket = io.connect();
				
				socket.on('connect', function() {
					console.log("Socket Connected");
					console.log("My socket id: ", socket.id);

					// Tell the server we want a list of the other users
					socket.emit('list');

					document.body.addEventListener('mousemove', function(e) {
						//console.log(e);
						canvas.style.top = e.clientY + "px";
						canvas.style.left = e.clientX + "px";
						socket.emit('move', {x: e.clientX, y: e.clientY});
					});

					socket.on("move", function(data) {
						document.getElementById(data.id).style.top = data.y + "px";
						document.getElementById(data.id).style.left = data.x + "px";
					})

				});

				socket.on('disconnect', function(data) {
					console.log("Socket disconnected");
				});

				socket.on('peer_disconnect', function(data) {
					console.log("simplepeer has disconnected " + data);
					for (let i = 0; i < simplepeers.length; i++) {
						if (simplepeers[i].socket_id == data) {
							console.log("Removing simplepeer: " + i);
							simplepeers.splice(i,1);
							// Should also remove video from page
							document.getElementById(data).remove();
						} 
					}			
				});			

				// Receive listresults from server
				socket.on('listresults', function (data) {
					console.log(data);
					for (let i = 0; i < data.length; i++) {
						// Make sure it's not us
						if (data[i] != socket.id) {	

							// create a new simplepeer and we'll be the "initiator"			
							let simplepeer = new SimplePeerWrapper(
								true, data[i], socket, mystream
							);

							// Push into our array
							simplepeers.push(simplepeer);	
						}
					}
				});
				
				socket.on('signal', function(to, from, data) {
				
					console.log("Got a signal from the server: ", to, from, data);

					// to should be us
					if (to != socket.id) {
						console.log("Socket IDs don't match");
					}
				
					// Look for the right simplepeer in our array
					let found = false;
					for (let i = 0; i < simplepeers.length; i++)
					{
						
						if (simplepeers[i].socket_id == from) {
							console.log("Found right object");
							// Give that simplepeer the signal
							simplepeers[i].inputsignal(data);
							found = true;
							break;
						}
					
					}	
					if (!found) {
						console.log("Never found right simplepeer object");
						// Let's create it then, we won't be the "initiator"
						let simplepeer = new SimplePeerWrapper(
							false, from, socket, mystream
						);
						
						// Push into our array
						simplepeers.push(simplepeer);	
							
						// Tell the new simplepeer that signal
						simplepeer.inputsignal(data);
					}
				});

			}

			// A wrapper for simplepeer as we need a bit more than it provides
			class SimplePeerWrapper {

 				constructor(initiator, socket_id, socket, stream) {
					this.simplepeer = new SimplePeer({
						config: { iceServers: [
							{ urls: 'stun:stun.l.google.com:19302' }, 
							{ urls: 'stun:stun2.l.google.com:19302' }] },
						initiator: initiator,
						trickle: false
					});				

					// Their socket id, our unique id for them
					this.socket_id = socket_id;

					// Socket.io Socket
					this.socket = socket;

					// Our video stream - need getters and setters for this
					this.stream = stream;

					// simplepeer generates signals which need to be sent across socket
					this.simplepeer.on('signal', data => {						
						this.socket.emit('signal', this.socket_id, this.socket.id, data);
					});

					// When we have a connection, send our stream
					this.simplepeer.on('connect', () => {
						console.log('CONNECT')
						console.log(this.simplepeer);
						//p.send('whatever' + Math.random())

						// Let's give them our stream
						this.simplepeer.addStream(stream);
						console.log("Send our stream");
					});

					// Stream coming in to us
					this.simplepeer.on('stream', stream => {
						console.log('Incoming Stream');

						// This should really be a callback
						// Create a video object
						let ovideo = document.createElement("VIDEO");
						ovideo.id = this.socket_id;
						ovideo.style.position = "absolute";
						ovideo.style.top = "0px";
						ovideo.style.left = "0px";
						ovideo.srcObject = stream;
						ovideo.muted = true;
						ovideo.onloadedmetadata = function(e) {
							ovideo.play();
						};					
						document.body.appendChild(ovideo);
						console.log(ovideo);
					});		
					
					this.simplepeer.on('close', () => {
						console.log('Got close event');
						// Should probably remove from the array of simplepeers
					});

					this.simplepeer.on('error', (err) => {
						console.log(err);
					});
				}
  
				inputsignal(sig) {
					this.simplepeer.signal(sig);
				}

			}			

			// When the user clicks on div, open the popup
function myFunction() {
  var popup = document.getElementById("myPopup");
  popup.classList.toggle("show");
}

function myFunction2() {
  var popup = document.getElementById("myPopup2");
  popup.classList.toggle("show");
}

function myFunction3() {
  var popup = document.getElementById("myPopup3");
  popup.classList.toggle("show");
}

function myFunction4() {
  var popup = document.getElementById("myPopup4");
  popup.classList.toggle("show");
}

function myFunction5() {
  var popup = document.getElementById("myPopup5");
  popup.classList.toggle("show");
}

function myFunction6() {
  var popup = document.getElementById("myPopup6");
  popup.classList.toggle("show");
}

function myFunction7() {
  var popup = document.getElementById("myPopup7");
  popup.classList.toggle("show");
}

function myFunction8() {
  var popup = document.getElementById("myPopup8");
  popup.classList.toggle("show");
}

function myFunction9() {
  var popup = document.getElementById("myPopup9");
  popup.classList.toggle("show");
}

function myFunction10() {
  var popup = document.getElementById("myPopup10");
  popup.classList.toggle("show");
}



		</script>
	</head>
  <body>
	<div>
		My Video:
		<video id="myvideo" width="400" height="300" muted style="display: none"></video>
		<canvas id="mycanvas" width="400" height="300" style="position: absolute; top: 0px; left: 0px"></canvas> 
	</div>

	<h2>Celestial Bodies</h2>

	<div class="popup" onclick="myFunction()">Sun
	  <span class="popuptext" id="myPopup">The Sun represents one's will and sense of vitality.</span>
	</div>

	<div class="popup2" onclick="myFunction2()">Moon
		<span class="popuptext2" id="myPopup2">The Moon describes one's emotions, desires and innermost mind.</span>
	  </div>

	  <div class="popup3" onclick="myFunction3()">Mercury
		<span class="popuptext3" id="myPopup3">Mercury represents communication, rationality and thought processes.</span>
	  </div>

	  <div class="popup4" onclick="myFunction4()">Venus
		<span class="popuptext4" id="myPopup4">Venus represents romantic indulgence, finances and material possessions.</span>
	  </div>

	  <div class="popup5" onclick="myFunction5()">Mars
		<span class="popuptext5" id="myPopup5">Mars represents desire, drive, energy and sexuality.</span>
	  </div>

	  <div class="popup6" onclick="myFunction6()">Jupiter
		<span class="popuptext6" id="myPopup6">Jupiter, the planet of abundance, represents acceptance of joy and optimism in life.</span>
	  </div>

	  <div class="popup7" onclick="myFunction7()">Saturn
		<span class="popuptext7" id="myPopup7">Saturn represents tenacity, ambition, discipline, productivity and tangible reward.</span>
	  </div>

	  <div class="popup8" onclick="myFunction8()">Uranus
		<span class="popuptext8" id="myPopup8">Uranus represents extremes, breakthroughs and breakdowns, limitlessness and otherness.</span>
	  </div>

	  <div class="popup9" onclick="myFunction9()">Neptune
		<span class="popuptext9" id="myPopup9">Neptune is the planet of inspiration. It deals with dreams, the subconscious, illusions and fantasies. It inspires compassion.</span>
	  </div>

	  <div class="popup10" onclick="myFunction10()">Pluto
		<span class="popuptext10" id="myPopup10">Pluto represents destruction and regeneration. It deals with transformation and rebirth.</span>
	  </div>





  </body>
</html>